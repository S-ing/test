# å®éªŒ6: FCMæœ€ä¼˜ç»„åˆéªŒè¯å®éªŒ          æ— é¢„è®­ç»ƒç‰ˆæœ¬
# ç›®æ ‡ï¼šç»“åˆæœ€ä½³FCMç»„ä»¶(P5+Type3)ä¸ä¹‹å‰æœ€ä¼˜é…ç½®ï¼Œå°è¯•æ¢å¤æˆ–è¶…è¶ŠåŸå§‹YOWOv3æ€§èƒ½
# åŸºäºï¼šP5å±‚çº§ + Type3 FCM + exp2_loss_weights_v2æŸå¤±æƒé‡ + exp4_fusion_attention
# é¢„æœŸï¼šmAP 88.0%+ (æ¢å¤åˆ°åŸå§‹YOWOv3æ°´å¹³)

BACKBONE2D:
  YOLOv8:
    ver : n

    PRETRAIN:
      n : null
      s : weights/backbone2D/YOLOv8/v8_s.pth
      m : weights/backbone2D/YOLOv8/v8_m.pth
      l : weights/backbone2D/YOLOv8/v8_l.pth
      x : weights/backbone2D/YOLOv8/v8_x.pth

BACKBONE3D:

  MOBILENET:
    width_mult: 2.0

    PRETRAIN:
      width_mult_0.5x  : weights/backbone3D/mobilenet/kinetics_mobilenet_0.5x_RGB_16_best.pth
      width_mult_1.0x  : weights/backbone3D/mobilenet/kinetics_mobilenet_1.0x_RGB_16_best.pth
      width_mult_1.5x  : weights/backbone3D/mobilenet/kinetics_mobilenet_1.5x_RGB_16_best.pth
      width_mult_2.0x  : weights/backbone3D/mobilenet/kinetics_mobilenet_2.0x_RGB_16_best.pth

  MOBILENETv2:
    width_mult: 1.0

    PRETRAIN:
      width_mult_0.2x  : weights/backbone3D/mobilenetv2/kinetics_mobilenetv2_0.2x_RGB_16_best.pth
      width_mult_0.45x : weights/backbone3D/mobilenetv2/kinetics_mobilenetv2_0.45x_RGB_16_best.pth
      width_mult_0.7x  : weights/backbone3D/mobilenetv2/kinetics_mobilenetv2_0.7x_RGB_16_best.pth
      width_mult_1.0x  : weights/backbone3D/mobilenetv2/kinetics_mobilenetv2_1.0x_RGB_16_best.pth

  SHUFFLENET:
    width_mult: 2.0

    PRETRAIN:
      width_mult_0.5x  : weights/backbone3D/shufflenet/kinetics_shufflenet_0.5x_G3_RGB_16_best.pth
      width_mult_1.0x  : weights/backbone3D/shufflenet/kinetics_shufflenet_1.0x_G3_RGB_16_best.pth
      width_mult_1.5x  : weights/backbone3D/shufflenet/kinetics_shufflenet_1.5x_RGB_16_best.pth
      width_mult_2.0x  : weights/backbone3D/shufflenet/kinetics_shufflenet_2.0x_RGB_16_best.pth

  SHUFFLENETv2:
    width_mult: 1.0

    PRETRAIN:
      width_mult_0.25x : weights/backbone3D/shufflenetv2/kinetics_shufflenetv2_0.25x_RGB_16_best.pth
      width_mult_1.0x  : weights/backbone3D/shufflenetv2/kinetics_shufflenetv2_1.0x_RGB_16_best.pth
      width_mult_1.5x  : weights/backbone3D/shufflenetv2/kinetics_shufflenetv2_1.5x_RGB_16_best.pth
      width_mult_2.0x  : weights/backbone3D/shufflenetv2/kinetics_shufflenetv2_2.0x_RGB_16_best.pth
      
  I3D:
    PRETRAIN:
      default: weights/backbone3D/I3D/rgb_imagenet.pth
  
  RESNET:
    ver : 101

    PRETRAIN:
      ver_18 : weights/backbone3D/resnet/kinetics_resnet_18_RGB_16_best.pth
      ver_50 : weights/backbone3D/resnet/kinetics_resnet_50_RGB_16_best.pth
      ver_101: weights/backbone3D/resnet/kinetics_resnet_101_RGB_16_best.pth

  RESNEXT:
    ver : 101

    PRETRAIN:
      ver_101 : weights/backbone3D/resnext/resnext-101-kinetics.pth

# ğŸ”¬ å®éªŒ6æ ¸å¿ƒç»„åˆ: FCMæœ€ä¼˜ç»„ä»¶ + æœ€ä¼˜æŸå¤±æƒé‡ + Attentionèåˆ
LOSS:
  TAL:
    top_k  : 10
    alpha  : 0.7
    beta   : 6.0
    radius : 2.5
    soft_label : False  # ä¿æŒåŸºçº¿æœ€ä¼˜è®¾ç½®

    # ğŸ¯ é‡‡ç”¨exp2_loss_weights_v2çš„æœ€ä¼˜æŸå¤±æƒé‡é…ç½®
    scale_cls_loss : 1.5   # å¼ºåŒ–åˆ†ç±»æŸå¤± (v2æœ€ä¼˜)
    scale_box_loss : 5.0   # é€‚åº¦è¾¹æ¡†æŸå¤± (v2æœ€ä¼˜)
    scale_dfl_loss : 1.0   # è½»é‡DFLæŸå¤± (v2æœ€ä¼˜)

  SIMOTA:
    top_k  : 10
    gamma  : 0.5
    radius : 2.5
    mode   : balance
    soft_label : True

    dynamic_k     : False
    dynamic_top_k : 40

    scale_cls_loss : 0.5
    scale_box_loss : 7.5
    scale_dfl_loss : 1.5

config_path       : config/exp6_fcm_optimal_combination.yaml
dataset           : ucf
loss              : tal
active_checker    : True
num_classes       : 24
backbone2D        : yolov8_fcm  # Use FCM-enhanced YOLOv8
backbone3D        : i3d
fusion_module     : EnhancedCFAM  # é‡‡ç”¨exp4_fusion_attentionçš„æœ€ä¼˜èåˆç­–ç•¥
mode              : decoupled

# é€šé“é…ç½® - é€‚åº”YOLOv8nçš„è¾“å‡º
# interchannels     : [256, 256, 256]
interchannels     : [64, 128, 256]
pretrain_path     : null
data_root         : /Xsb/YOWOv4/ucf24
img_size          : 224
clip_length       : 16

batch_size        : 16
num_workers       : 8
acc_grad          : 16

lr                : 0.001
weight_decay      : 0.0005
max_step_warmup   : 800
adjustlr_schedule : [1, 2, 3, 4, 5]
max_epoch         : 7
lr_decay          : 0.5
save_folder       : weights/exp6_fcm_optimal_combination_1003_init
sampling_rate     : 1
dropout           : 0.3          # é™ä½dropoutï¼Œé¿å…è¿‡åº¦æ­£åˆ™åŒ–

# FCMæ¶æ„å¢å¼ºé…ç½® - ä½¿ç”¨æœ€ä½³ç»„ä»¶ç»„åˆ
FCM_ENHANCEMENTS:
  # FCMæ ¸å¿ƒé…ç½®
  fcm_enabled: True
  feature_levels: ['P5']         # ä»…ä½¿ç”¨P5å±‚çº§ï¼ˆæ¶ˆèå®éªŒæœ€ä½³ï¼‰
  fusion_type: 'type3'           # ä½¿ç”¨Type3èåˆç­–ç•¥ï¼ˆæ¶ˆèå®éªŒæœ€ä½³ï¼‰
  channels: 256                  # ç®€åŒ–é…ç½®ï¼Œé¿å…è¿‡åº¦å¤æ‚åŒ–
  
  # å¤šå°ºåº¦æ³¨æ„åŠ›é…ç½®
  multi_scale_attention:
    enabled: True
    scales: [1, 2, 4]            # å¤šå°ºåº¦å› å­
    fusion_type: 'weighted'       # èåˆæ–¹å¼ï¼šweighted, concat, add
  
  # åŠ¨æ€èåˆé…ç½®
  dynamic_fusion:
    enabled: True
    learnable_weights: True       # å­¦ä¹ èåˆæƒé‡
    temperature: 1.0             # è½¯æ³¨æ„åŠ›æ¸©åº¦å‚æ•°
  
  # æ€§èƒ½ç›‘æ§é…ç½®
  performance_monitor:
    enabled: True
    log_flops: True              # è®°å½•FLOPs
    log_params: True             # è®°å½•å‚æ•°é‡
    log_memory: True             # è®°å½•å†…å­˜ä½¿ç”¨
    profile_frequency: 100       # æ€§èƒ½åˆ†æé¢‘ç‡

# æ•°æ®å¢å¼ºé…ç½®
DATA_AUGMENTATION:
  # ç©ºé—´å¢å¼º
  spatial:
    random_crop: True
    random_flip: True
    random_rotation: 15          # éšæœºæ—‹è½¬è§’åº¦
    color_jitter: 0.2            # é¢œè‰²æŠ–åŠ¨å¼ºåº¦
    mosaic_prob: 0.5             # Mosaicå¢å¼ºæ¦‚ç‡
    mixup_prob: 0.15             # Mixupå¢å¼ºæ¦‚ç‡
  
  # æ—¶é—´å¢å¼º
  temporal:
    random_temporal_crop: True
    temporal_stride: [1, 2]      # æ—¶é—´æ­¥é•¿å˜åŒ–
    frame_dropout: 0.1           # å¸§ä¸¢å¼ƒæ¦‚ç‡

# ä¼˜åŒ–å™¨é…ç½®
OPTIMIZER:
  type: 'AdamW'                  # ä¼˜åŒ–å™¨ç±»å‹
  betas: [0.9, 0.999]            # Adamå‚æ•°
  eps: 1e-8                      # æ•°å€¼ç¨³å®šæ€§å‚æ•°
  amsgrad: False                 # æ˜¯å¦ä½¿ç”¨AMSGrad

# å­¦ä¹ ç‡è°ƒåº¦å™¨é…ç½®
SCHEDULER:
  type: 'CosineAnnealingLR'      # ä½™å¼¦é€€ç«å­¦ä¹ ç‡
  T_max: 50                      # å‘¨æœŸé•¿åº¦
  eta_min: 1e-6                  # æœ€å°å­¦ä¹ ç‡
  warmup_type: 'linear'          # é¢„çƒ­ç±»å‹
  warmup_epochs: 5               # é¢„çƒ­è½®æ•°

# æ€§èƒ½ç›‘æ§é…ç½®
PERFORMANCE_MONITORING:
  enabled: True
  target_metrics:
    mAP: 88.0                    # ç›®æ ‡mAP (æ¢å¤åˆ°åŸå§‹YOWOv3æ°´å¹³)
    FLOPs: "maintain"            # ä¿æŒè®¡ç®—æ•ˆç‡
    Params: "maintain"           # ä¿æŒå‚æ•°é‡
  log_frequency: 50
  tensorboard: True


# UCF24æ•°æ®é›†ç±»åˆ«æ˜ å°„ - ä¸åŸºçº¿å®Œå…¨ä¸€è‡´
idx2name:
  0  : Baseketball
  1  : BaseketballDunk
  2  : Biking
  3  : CliffDiving
  4  : CricketBowling
  5  : Diving
  6  : Fencing
  7  : FloorGymnastics
  8  : GolfSwing
  9  : HorseRiding
  10 : IceDancing
  11 : LongJump
  12 : PoleVault
  13 : RopeClimbing
  14 : SalsaSpin
  15 : SkateBoarding
  16 : Skiing
  17 : Skijet  
  18 : Soccer Juggling
  19 : Surfing
  20 : TennisSwing
  21 : TrampolineJumping
  22 : VolleyballSpiking
  23 : WalkingWithDog

# å®éªŒå…ƒä¿¡æ¯
EXPERIMENT_META:
  name: "exp6_fcm_optimal_combination"
  description: "Combining best FCM components (P5+Type3) with optimal loss weights and attention fusion"
  target_performance: "88.0%+ mAP (match or exceed original YOWOv3)"
  baseline_comparison: "89.25.yaml"
  key_innovations:
    - "P5å±‚çº§FCMé…ç½®ï¼ˆæ¶ˆèå®éªŒæœ€ä½³ï¼‰"
    - "Type3èåˆç­–ç•¥ï¼ˆæ¶ˆèå®éªŒæœ€ä½³ï¼‰"
    - "exp2_loss_weights_v2æœ€ä¼˜æŸå¤±æƒé‡"
    - "exp4_fusion_attentionæ³¨æ„åŠ›èåˆ"
  expected_results:
    mAP: "88.0-88.5%"
    efficiency: "ä¿æŒæˆ–ç•¥å¾®ä¼˜åŒ–"
    validation: "FCMæ¨¡å—ä¸å…¶ä»–ä¼˜åŒ–ç»„ä»¶ååŒå·¥ä½œ"
