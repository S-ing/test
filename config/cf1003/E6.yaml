# YOLOv8-FCM:l  i3d
# interchannels     : [64, 128, 256]

BACKBONE2D:
  YOLOv8:
    ver : l

    PRETRAIN:
      n : weights/backbone2D/YOLOv8/v8_n.pth
      s : weights/backbone2D/YOLOv8/v8_s.pth
      m : weights/backbone2D/YOLOv8/v8_m.pth
      l : weights/backbone2D/YOLOv8/v8_l.pth
      x : weights/backbone2D/YOLOv8/v8_x.pth

    # FCM Configuration - FCM_3 TYPE ONLY
    FCM:
      enable: true
      positions: ['p5']  # All positions
      fpn_positions: ['h2', 'h4', 'h6']  # All FPN positions
      types:
        p5: 'FCM_3'  # Use FCM_3 for all levels

BACKBONE3D:

  MOBILENET:
    width_mult: 2.0

    PRETRAIN:
      width_mult_0.5x  : weights/backbone3D/mobilenet/kinetics_mobilenet_0.5x_RGB_16_best.pth
      width_mult_1.0x  : weights/backbone3D/mobilenet/kinetics_mobilenet_1.0x_RGB_16_best.pth
      width_mult_1.5x  : weights/backbone3D/mobilenet/kinetics_mobilenet_1.5x_RGB_16_best.pth
      width_mult_2.0x  : weights/backbone3D/mobilenet/kinetics_mobilenet_2.0x_RGB_16_best.pth

  MOBILENETv2:
    width_mult: 1.0

    PRETRAIN:
      width_mult_0.2x  : weights/backbone3D/mobilenetv2/kinetics_mobilenetv2_0.2x_RGB_16_best.pth
      width_mult_0.45x : weights/backbone3D/mobilenetv2/kinetics_mobilenetv2_0.45x_RGB_16_best.pth
      width_mult_0.7x  : weights/backbone3D/mobilenetv2/kinetics_mobilenetv2_0.7x_RGB_16_best.pth
      width_mult_1.0x  : weights/backbone3D/mobilenetv2/kinetics_mobilenetv2_1.0x_RGB_16_best.pth

  SHUFFLENET:
    width_mult: 2.0

    PRETRAIN:
      width_mult_0.5x  : weights/backbone3D/shufflenet/kinetics_shufflenet_0.5x_G3_RGB_16_best.pth
      width_mult_1.0x  : weights/backbone3D/shufflenet/kinetics_shufflenet_1.0x_G3_RGB_16_best.pth
      width_mult_1.5x  : weights/backbone3D/shufflenet/kinetics_shufflenet_1.5x_RGB_16_best.pth
      width_mult_2.0x  : weights/backbone3D/shufflenet/kinetics_shufflenet_2.0x_RGB_16_best.pth

  SHUFFLENETv2:
    width_mult: 2.0

    PRETRAIN:
      width_mult_0.25x : weights/backbone3D/shufflenetv2/kinetics_shufflenetv2_0.25x_RGB_16_best.pth
      width_mult_1.0x  : weights/backbone3D/shufflenetv2/kinetics_shufflenetv2_1.0x_RGB_16_best.pth
      width_mult_1.5x  : weights/backbone3D/shufflenetv2/kinetics_shufflenetv2_1.5x_RGB_16_best.pth
      width_mult_2.0x  : weights/backbone3D/shufflenetv2/kinetics_shufflenetv2_2.0x_RGB_16_best.pth
      
  I3D:
    PRETRAIN:
      default: weights/backbone3D/I3D/rgb_imagenet.pth
  
  RESNET:
    ver : 101

    PRETRAIN:
      ver_18 : weights/backbone3D/resnet/kinetics_resnet_18_RGB_16_best.pth
      ver_50 : weights/backbone3D/resnet/kinetics_resnet_50_RGB_16_best.pth
      ver_101: weights/backbone3D/resnet/kinetics_resnet_101_RGB_16_best.pth

  RESNEXT:
    ver : 101

    PRETRAIN:
      ver_101 : weights/backbone3D/resnext/resnext-101-kinetics.pth

# ğŸ”¬ å®éªŒ5æ ¸å¿ƒç»„åˆ: æœ€ä¼˜æŸå¤±æƒé‡ + Attentionèåˆ
LOSS:
  TAL:
    top_k  : 10
    alpha  : 0.7
    beta   : 6.0
    radius : 2.5
    soft_label : False  # ä¿æŒåŸºçº¿æœ€ä¼˜è®¾ç½®

    # ğŸ¯ é‡‡ç”¨exp2_loss_weights_v2çš„æœ€ä¼˜æŸå¤±æƒé‡é…ç½®
    scale_cls_loss : 1.5   # å¼ºåŒ–åˆ†ç±»æŸå¤± (v2æœ€ä¼˜)
    scale_box_loss : 5.0   # é€‚åº¦è¾¹æ¡†æŸå¤± (v2æœ€ä¼˜)
    scale_dfl_loss : 1.0   # è½»é‡DFLæŸå¤± (v2æœ€ä¼˜)

  SIMOTA:
    top_k  : 10
    gamma  : 0.5
    radius : 2.5
    mode   : balance
    soft_label : False

    dynamic_k     : False
    dynamic_top_k : 40

    scale_cls_loss : 0.5
    scale_box_loss : 7.5
    scale_dfl_loss : 1.5

# Training configuration - FCM_3 type only
config_path       : config/cf1003/E6.yaml
dataset           : ucf
loss              : tal
active_checker    : True
num_classes       : 24
backbone2D        : yolov8_fcm  # Use FCM-enhanced YOLOv8
backbone3D        : i3d
fusion_module     : EnhancedCFAM  # é‡‡ç”¨exp4_fusion_attentionçš„æœ€ä¼˜èåˆç­–ç•¥
mode              : decoupled


interchannels     : [64, 128, 256]
pretrain_path     : weights/cf1003/E6_1010/ema_epoch_7.pth
data_root         : /Ylj/YOWOv3/ucf24
img_size          : 224
clip_length       : 16

batch_size        : 16
num_workers       : 8
acc_grad          : 16

lr                : 0.001
weight_decay      : 0.0005
max_step_warmup   : 500
adjustlr_schedule : [1, 2, 3, 4, 5]
max_epoch         : 7
lr_decay          : 0.5
save_folder       : weights/cf1003/E6_1010
sampling_rate     : 1
dropout           : 0.3          # é™ä½dropoutï¼Œé¿å…è¿‡åº¦æ­£åˆ™åŒ–

# æ¶æ„å¢å¼ºé…ç½®
ENHANCEMENTS:
  # å¤šå°ºåº¦æ³¨æ„åŠ›é…ç½®
  multi_scale_attention:
    enabled: True
    scales: [1, 2, 4]        # å¤šå°ºåº¦å› å­
    fusion_type: 'weighted'   # èåˆæ–¹å¼ï¼šweighted, concat, add
  
  # åŠ¨æ€èåˆé…ç½®
  dynamic_fusion:
    enabled: True
    learnable_weights: True   # å­¦ä¹ èåˆæƒé‡
    temperature: 1.0         # è½¯æ³¨æ„åŠ›æ¸©åº¦å‚æ•°
  
  # æ€§èƒ½ç›‘æ§é…ç½®
  performance_monitor:
    enabled: True
    log_flops: True          # è®°å½•FLOPs
    log_params: True         # è®°å½•å‚æ•°é‡
    log_memory: True         # è®°å½•å†…å­˜ä½¿ç”¨
    profile_frequency: 100   # æ€§èƒ½åˆ†æé¢‘ç‡

# æ•°æ®å¢å¼ºé…ç½®
DATA_AUGMENTATION:
  # ç©ºé—´å¢å¼º
  spatial:
    random_crop: True
    random_flip: True
    random_rotation: 15      # éšæœºæ—‹è½¬è§’åº¦
    color_jitter: 0.2        # é¢œè‰²æŠ–åŠ¨å¼ºåº¦
  
  # æ—¶é—´å¢å¼º
  temporal:
    random_temporal_crop: True
    temporal_stride: [1, 2]  # æ—¶é—´æ­¥é•¿å˜åŒ–
    frame_dropout: 0.1       # å¸§ä¸¢å¼ƒæ¦‚ç‡

# ä¼˜åŒ–å™¨é…ç½®
OPTIMIZER:
  type: 'AdamW'              # ä¼˜åŒ–å™¨ç±»å‹
  betas: [0.9, 0.999]        # Adamå‚æ•°
  eps: 1e-8                  # æ•°å€¼ç¨³å®šæ€§å‚æ•°
  amsgrad: False             # æ˜¯å¦ä½¿ç”¨AMSGrad

# å­¦ä¹ ç‡è°ƒåº¦å™¨é…ç½®
SCHEDULER:
  type: 'CosineAnnealingLR'  # ä½™å¼¦é€€ç«å­¦ä¹ ç‡
  T_max: 10                  # å‘¨æœŸé•¿åº¦
  eta_min: 1e-6              # æœ€å°å­¦ä¹ ç‡
  warmup_type: 'linear'      # é¢„çƒ­ç±»å‹
  
# UCF24 dataset class mapping - consistent with baseline
idx2name:
  0  : Baseketball
  1  : BaseketballDunk
  2  : Biking
  3  : CliffDiving
  4  : CricketBowling
  5  : Diving
  6  : Fencing
  7  : FloorGymnastics
  8  : GolfSwing
  9  : HorseRiding
  10 : IceDancing
  11 : LongJump
  12 : PoleVault
  13 : RopeClimbing
  14 : SalsaSpin
  15 : SkateBoarding
  16 : Skiing
  17 : Skijet  
  18 : Soccer Juggling
  19 : Surfing
  20 : TennisSwing
  21 : TrampolineJumping
  22 : VolleyballSpiking
  23 : WalkingWithDog